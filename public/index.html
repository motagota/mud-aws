<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modern MUD Terminal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.1/socket.io.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Basic styling for the button */
        #connection-button {
          position: fixed;
          top: 10px;
          right: 10px;
          padding: 10px;
          background-color: #007bff;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 5px;
          width: 120px; /* Fixed width */
          justify-content: center; /* Center content horizontally */
        }
  
        #connection-button.disconnected {
        background-color: #dc3545;
      }

      #connection-button.connecting {
        background-color: #ffc107; /* Yellow for connecting state */
      }
  
        #root {
          margin-top: 50px; /* Add some margin to avoid overlap with the button */
        }
      </style>

  </head>
  <body>
     <!-- Connection button -->
     <button id="connection-button">
        <i class="fas fa-plug"></i> Connect
      </button>

    <div id="root">hello</div>

    <script>
      const socket = io("http://localhost:3030");
      const connectionButton = document.getElementById("connection-button");

// Track connection state
let isConnected = false;
let isConnecting = false;
// Function to update button state
const updateButtonState = () => {
        if (isConnected) {
          connectionButton.innerHTML = '<i class="fas fa-plug"></i> Disconnect';
          connectionButton.classList.remove("disconnected", "connecting");
        } else if (isConnecting) {
          connectionButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting';
          connectionButton.classList.add("connecting");
          connectionButton.classList.remove("disconnected");
        } else {
          connectionButton.innerHTML = '<i class="fas fa-plug"></i> Connect';
          connectionButton.classList.add("disconnected");
          connectionButton.classList.remove("connecting");
        }
      };

      // Handle button click
      connectionButton.addEventListener("click", () => {
        if (isConnected) {
          socket.disconnect(); // Disconnect from the server
          isConnected = false;
          isConnecting = false;
        } else {
          isConnecting = true;
          updateButtonState();
          socket.connect(); // Attempt to connect to the server
        }
        updateButtonState();
      });

      // Socket connection events
      socket.on("connect", () => {
        isConnected = true;
        isConnecting = false;
        updateButtonState();
      });

      socket.on("disconnect", () => {
        isConnected = false;
        isConnecting = false;
        updateButtonState();
      });

      socket.on("connect_error", () => {
        isConnected = false;
        isConnecting = false;
        updateButtonState();
        alert("Failed to connect to the server."); // Notify user of connection failure
      });
    </script>
  </body>
</html>